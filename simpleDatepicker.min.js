(function(a){a.fn.simpleDatepicker=function(u){function v(){a(this).parent().wrap('<div class="datepicker-wrapper">').addClass("datepicker-container");var d=a(this).parents(".datepicker-wrapper");d.css("display","inline-block");a('<span class="datepicker-label">'+k.labelText+"</span>").prependTo(d).css("cursor","pointer")}function w(){var d=new n(k.startYear,k.startMonth),c=a(this).parent();c.css("position","relative");a('<div class="datepicker"></div>').appendTo(c);var g=c.find(".datepicker");a('<div class="calendar-header"></div>').prependTo(g);
a('<span class="visible-year"><span class="year-down date-control date-control-down"> < </span><span class="year-value">'+d.calendarYear+'</span><span class="year-up date-control date-control-up"> > </span></span>').prependTo(g.find(".calendar-header"));a('<span class="visible-month"><span class="month-down date-control date-control-down"> < </span><span class="month-value">'+d.calendarMonth+'</span><span class="month-up date-control date-control-up"> > </span></span>').appendTo(g.find(".calendar-header"));
a('<div class="calendar-table">'+d.calendarBody+"</div>").appendTo(g);k.dateRange?c.css("float","left"):(c.css("position","absolute"),a(this).parent().hide());c.find(".date-control").css("cursor","pointer");a(this).hide();a('label[for="'+a(this).attr("id")+'"]').hide()}function x(){var d=a(this).parent(),c=a(this).parents(".datepicker-wrapper");d.clone().appendTo(c);var g=d.next(),c=c.find(".datepicker-container"),h=d.attr("id"),f=d.children("input"),b=g.children("input"),e=d.children("input").attr("id");
c.wrapAll('<div class="date-range-picker">');a(".date-range-picker").hide().css("position","absolute");h.length&&(d.attr("id",h+"1"),g.attr("id",h+"2"));e.length&&b.attr("id",e+"-to");g.find(".date-control-down").addClass("date-control-disabled");f.addClass("date-from");b.addClass("date-to");g.find("td:not(.not-current-month)").addClass("disabled-day");b.each(p);b.each(q);b.each(r)}function p(){function d(b){var e=a(this).parent().find(".year-value"),l=a(this).parents(".calendar-header").find(".month-value"),
c=a(this).parents(".calendar-header").next();b=g({year:e.text(),month:h(l.text()),shiftYear:!0,direction:b.data.direction});e.text(b.calendarYear);c.html(b.calendarBody);if(k.dateRange){var c=a(this).parents(".date-range-picker").find(".date-from").parent(),e=a(this).parents(".date-range-picker").find(".date-to").parent(),d=c.find(".year-value"),c=e.find(".year-value");b=e.find(".month-value");var l=e.find(".calendar-table"),f=e.find(".date-control-down");d.text()>=c.text()?(f.addClass("date-control-disabled"),
d=g({year:d.text()-1,month:h(b.text()),shiftYear:!0,direction:!0}),c.text(d.calendarYear),b.text(d.calendarMonth),l.html(d.calendarBody),e.find("td").addClass("disabled-day"),a(this).parents(".datepicker-wrapper").find(".datepicker-label").text(k.labelText)):(f.removeClass("date-control-disabled"),e.find("td").removeClass("disabled-day"))}}function c(b){var e=a(this).parent().find(".month-value"),c=a(this).parents(".calendar-header").find(".year-value"),d=a(this).parents(".calendar-header").next();
b=g({year:c.text(),month:h(e.text()),shiftMonth:!0,direction:b.data.direction});e.text(b.calendarMonth);c.text(b.calendarYear);d.html(b.calendarBody);if(k.dateRange&&a(this).parents(".datepicker").prev().hasClass("date-from")){var f=a(this).parents(".datepicker-container").next(),d=f.find(".month-value");b=f.find(".year-value");var f=f.find(".calendar-table"),e=h(e.text()),m=h(d.text()),n=0;0===e&&(n=1);if(e>m&&c.text()===b.text()||n&&c.text()>b.text())c=g({year:b.text(),month:m,shiftMonth:!0,direction:!0}),
d.text(c.calendarMonth),b.text(c.calendarYear),f.html(c.calendarBody)}e=a(this).parents(".date-range-picker").find(".date-from").parent();c=h(e.find(".month-value").text());d=a(this).parents(".date-range-picker").find(".date-to").parent();b=h(d.find(".month-value").text());e=e.find(".year-value").text();f=d.find(".year-value").text();m=d.find(".month-down");c>=b&&e===f?(m.addClass("date-control-disabled"),d.find("td").addClass("disabled-day")):(m.removeClass("date-control-disabled"),d.find("td").removeClass("disabled-day"))}
function g(b){b.month++;var a;if(b.shiftYear)b.direction?b.year++:b.year--;else{b.direction?b.month++:b.month--;a=b.year;var c=b.month;switch(c){case 0:c+=12;a--;break;case 13:c-=12,a++}a=[a,c];b.year=a[0];b.month=a[1]}return new n(b.year,b.month)}function h(b){for(var a=0;a<m[k.lang].length&&b!==m[k.lang][a];a++);return a}var f=a(this).parent();f.on("click",".year-down:not(.date-control-disabled)",{direction:!1},d);f.on("click",".year-up",{direction:!0},d);f.on("click",".month-down:not(.date-control-disabled)",
{direction:!1},c);f.on("click",".month-up",{direction:!0},c)}function q(){var d=a(this).parent().find(".calendar-table"),c=a(this).parent().find(".month-value"),g=a(this).parent().find(".year-value");d.on("click","td:not(.not-current-month, .disabled-day)",function(){for(var d=g.text(),f=c.text(),b=a(this).text(),e=a(this).parents(".datepicker").prevAll("input"),l,s=m[k.lang],n=0;n<s.length;n++)if(f===s[n]){l=n+1;break}l=10>l?"0"+l.toString():l.toString();b=10>b?"0"+b.toString():b.toString();e.val(d+
"-"+l+"-"+b).trigger("change");if(k.dateRange&&e.hasClass("date-from"))for(d=e.parents(".date-range-picker").find(".date-to").parent().find("td:not(.not-current-month)"),f=0;f<d.length;f++)parseInt(d.eq(f).text())<parseInt(a(this).text())?d.eq(f).addClass("disabled-day"):d.eq(f).removeClass("disabled-day")})}function r(){a(this).change(function(){function d(a,b){var c=b.nextAll(".calendar-label-separator");a.text()&&!c.text()&&b.after('<span class="calendar-label-separator"> - </span>')}a(this).val();
var c=a(this).parents(".datepicker-wrapper").children(".datepicker-label"),g=new Date(a(this).val()),g=g.getDate()+" "+m[k.lang][g.getMonth()]+" "+g.getFullYear();if(k.dateRange){c.text()===k.labelText&&(c.html('<span class="label-from"></span>'),a('<span class="label-to"></span>').appendTo(c));var h=c.children(".label-from"),c=c.children(".label-to");switch(a(this).attr("class")){case "date-from":h.text(g);d(c,h);break;case "date-to":c.text(g),d(h,h)}}else c.text(g)})}function y(){var d=a(this).parents(".datepicker-wrapper").children(".datepicker-label"),
c=d.next();d.click(function(){c.fadeToggle("fast");c.toggleClass("expanded")});a(document).click(function(d){a(d.target).closest(".datepicker-wrapper").length||(c.hasClass("expanded")&&(c.removeClass("expanded"),c.fadeOut("fast")),d.stopPropagation())})}function n(a,c){function g(a){a=a.getDay();0===a&&(a=7);return a-1}for(var h=c-1,f=new Date(a,h),b="<table><tr>",e=0;e<t[k.lang].length;e++)b+="<td>"+t[k.lang][e]+"</td>";for(var b=b+"</tr>",e=0,l=g(f)-1;e<g(f);e++,l--)b+='<td class="not-current-month">'+
(new Date(a,h,-l)).getDate()+"</td>";for(l=1;f.getMonth()===h;)b+="<td>"+f.getDate()+"</td>",6===g(f)%7&&(b+="<tr></tr>"),f.setDate(f.getDate()+1),l++;if(g(f))for(e=g(f);7>e;e++,l++)b+='<td class="not-current-month">'+(new Date(a,h,l)).getDate()+"</td>";h=m[k.lang][h];this.calendarYear=a;this.calendarMonth=h;this.calendarBody=b}var k=a.extend({},{startYear:(new Date).getFullYear(),startMonth:(new Date).getMonth()+1,labelText:"Choose a date",lang:"en",dateRange:!1},u),m={ru:"\u042f\u043d\u0432\u0430\u0440\u044c \u0424\u0435\u0432\u0440\u0430\u043b\u044c \u041c\u0430\u0440\u0442 \u0410\u043f\u0440\u0435\u043b\u044c \u041c\u0430\u0439 \u0418\u044e\u043d\u044c \u0418\u044e\u043b\u044c \u0410\u0432\u0433\u0443\u0441\u0442 \u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c \u041e\u043a\u0442\u044f\u0431\u0440\u044c \u041d\u043e\u044f\u0431\u0440\u044c \u0414\u0435\u043a\u0430\u0431\u0440\u044c".split(" "),
en:"Jan Feb March Apr May June July Aug Sept Oct Nov Dec".split(" ")},t={ru:"\u043f\u043d \u0432\u0442 \u0441\u0440 \u0447\u0442 \u043f\u0442 \u0441\u0431 \u0432\u0441".split(" "),en:"Mon Tue Wed Thu Fri Sat Sun".split(" ")};return this.each(function(){a(this).is('input[type="date"]')?(a(this).each(v),a(this).each(w),k.dateRange&&a(this).each(x),a(this).each(y),a(this).each(p),a(this).each(q),a(this).each(r)):console.error("Illegal choice")})}})(jQuery);