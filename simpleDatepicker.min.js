(function(c){c.fn.simpleDatepicker=function(y){function z(){c(this).parent().wrap('<div class="datepicker-wrapper">').addClass("datepicker-container");var a=c(this).parents(".datepicker-wrapper");a.css("display","inline-block");c('<span class="datepicker-label">'+f.labelText+"</span>").prependTo(a).css("cursor","pointer")}function A(){var a=new s(f.startYear,f.startMonth),d=c(this).parent();d.css("position","relative");c('<div class="datepicker"></div>').appendTo(d);var b=d.find(".datepicker");c('<div class="calendar-header"></div>').prependTo(b);
c('<span class="visible-year"><span class="year-down date-control date-control-down"> < </span><span class="year-value">'+a.calendarYear+'</span><span class="year-up date-control date-control-up"> > </span></span>').appendTo(b.find(".calendar-header"));c('<span class="visible-month"><span class="month-down date-control date-control-down"> < </span><span class="month-value">'+a.calendarMonth+'</span><span class="month-up date-control date-control-up"> > </span></span>').prependTo(b.find(".calendar-header"));
c('<div class="calendar-table">'+a.calendarBody+"</div>").appendTo(b);f.dateRange?d.css("float","left"):(d.css("position","absolute"),c(this).parent().hide());d.find(".date-control").css("cursor","pointer");c(this).hide();c('label[for="'+c(this).attr("id")+'"]').hide()}function B(){var a=c(this).parent(),d=c(this).parents(".datepicker-wrapper");a.clone().appendTo(d);var b=a.next(),d=d.find(".datepicker-container"),g=a.attr("id"),k=a.children("input"),h=b.children("input"),e=a.children("input").attr("id");
d.wrapAll('<div class="date-range-picker">');c(".date-range-picker").hide().css("position","absolute");g&&(a.attr("id",g+"1"),b.attr("id",g+"2"));e&&h.attr("id",e+"-to");b.find(".date-control-down").addClass("date-control-disabled");k.addClass("date-from");h.addClass("date-to");b.find("td:not(.not-current-month)").addClass("disabled-day");h.each(t);h.each(u);f.showInLabel&&h.each(v)}function C(){c('<ul class="fixed-range"></ul>').appendTo(f.fixedRangeInner);var a=f.fixedRangeInner.children(".fixed-range");
c('<li class="today fixed-range-item"><a href="javascript:void(0)">\u0417\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f</a></li>').prependTo(a);c('<li class="this-week fixed-range-item"><a href="javascript:void(0)">\u0417\u0430 \u043d\u0435\u0434\u0435\u043b\u044e</a></li>').appendTo(a);c('<li class="this-month fixed-range-item"><a href="javascript:void(0)">\u0417\u0430 \u043c\u0435\u0441\u044f\u0446</a></li>').appendTo(a)}function D(){var a=f.fixedRangeInner.children(".fixed-range").children(".fixed-range-item").children("a"),
d=c(this),b=c(this).parents(".datepicker-wrapper").find(".date-to");a.click(function(){var g=new Date,k=c(this).parent(),a=r(g.getFullYear(),g.getMonth(),g.getDate());c(this).addClass("current-range");k.siblings().children().removeClass("current-range");n(b,a);k.hasClass("today")?n(d,b.val()):k.hasClass("this-week")?(k=r(g.getFullYear(),g.getMonth(),g.getDate()-7),n(d,k)):k.hasClass("this-month")&&(k=r(g.getFullYear(),g.getMonth()-1,g.getDate()),n(d,k));var e=c(b).next(),k=e.find(".month-value"),
a=e.find(".year-value"),e=e.find(".calendar-table");q({year:g.getFullYear(),month:g.getMonth()+1,direction:!1,yearInner:a,monthInner:k,tableInner:e})});d.change(function(){var g=new Date(d.val()),b=c(d).next(),a=b.find(".month-value"),e=b.find(".year-value"),b=b.find(".calendar-table");q({year:g.getFullYear(),month:g.getMonth()+1,direction:!1,yearInner:e,monthInner:a,tableInner:b})})}function t(){function a(b){var a=c(this).parent().find(".year-value"),d=c(this).parents(".calendar-header").find(".month-value"),
e=c(this).parents(".calendar-header").next();q({year:a.text(),month:m[f.lang].indexOf(d.text()),shiftYear:!0,direction:b.data.direction,yearInner:a,tableInner:e});if(f.dateRange){a=c(this).parents(".date-range-picker").find(".date-from").parent();b=c(this).parents(".date-range-picker").find(".date-to").parent();var a=a.find(".year-value"),d=b.find(".year-value"),e=b.find(".month-value"),l=b.find(".calendar-table"),p=b.find(".date-control-down");a.text()>=d.text()?(p.addClass("date-control-disabled"),
q({year:a.text()-1,month:m[f.lang].indexOf(e.text()),shiftYear:!0,direction:!0,yearInner:d,monthInner:e,tableInner:l}),b.find("td").addClass("disabled-day"),c(this).parents(".datepicker-wrapper").find(".datepicker-label").text(f.labelText)):(p.removeClass("date-control-disabled"),b.find("td").removeClass("disabled-day"))}}function d(b){var a=c(this).parent().find(".month-value"),d=c(this).parents(".calendar-header").find(".year-value"),e=c(this).parents(".calendar-header").next();q({year:d.text(),
month:m[f.lang].indexOf(a.text()),direction:b.data.direction,yearInner:d,monthInner:a,tableInner:e});if(f.dateRange&&c(this).parents(".datepicker").prev().hasClass("date-from")){var l=c(this).parents(".datepicker-container").next();b=l.find(".month-value");var e=l.find(".year-value"),l=l.find(".calendar-table"),a=m[f.lang].indexOf(a.text()),p=m[f.lang].indexOf(b.text()),n=0;0===a&&(n=1);(a>p&&d.text()===e.text()||n&&d.text()>e.text())&&q({year:e.text(),month:p,direction:!0,yearInner:e,monthInner:b,
tableInner:l})}a=c(this).parents(".date-range-picker").find(".date-from").parent();d=m[f.lang].indexOf(a.find(".month-value").text());b=c(this).parents(".date-range-picker").find(".date-to").parent();e=m[f.lang].indexOf(b.find(".month-value").text());a=a.find(".year-value").text();l=b.find(".year-value").text();p=b.find(".month-down");d>=e&&a===l?(p.addClass("date-control-disabled"),b.find("td").addClass("disabled-day")):(p.removeClass("date-control-disabled"),b.find("td").removeClass("disabled-day"))}
var b=c(this).parent();b.on("click",".year-down:not(.date-control-disabled)",{direction:!1},a);b.on("click",".year-up",{direction:!0},a);b.on("click",".month-down:not(.date-control-disabled)",{direction:!1},d);b.on("click",".month-up",{direction:!0},d)}function u(){var a=c(this).parent().find(".calendar-table"),d=c(this).parent().find(".month-value"),b=c(this).parent().find(".year-value");a.on("click","td:not(.not-current-month, .disabled-day)",function(){var a=b.text(),k=d.text(),h=c(this).text(),
e=c(this).parents(".datepicker").prevAll("input"),l=m[f.lang].indexOf(k);f.fixedRange&&c(".fixed-range").find("a").removeClass("current-range");n(e,r(a,l,h));if(f.dateRange&&e.hasClass("date-from")&&(l=e.parents(".date-range-picker").find(".date-to").parent(),h=l.find("td:not(.not-current-month)"),e=l.find(".year-value"),l=l.find(".month-value"),parseInt(a)===parseInt(e.text())&&m[f.lang].indexOf(k)===m[f.lang].indexOf(l.text())))for(a=0;a<h.length;a++)parseInt(h.eq(a).text())<parseInt(c(this).text())?
h.eq(a).addClass("disabled-day"):h.eq(a).removeClass("disabled-day")})}function r(a,d,b){d=w(d+1);b=w(b);return a+"-"+d+"-"+b}function w(a){return 10>a?"0"+a.toString():a.toString()}function n(a,d){a.val(d).trigger("change")}function v(){c(this).change(function(){function a(a,b){var d=b.nextAll(".calendar-label-separator");a.text()&&!d.text()&&b.after('<span class="calendar-label-separator"> - </span>')}var d=c(this).parents(".datepicker-wrapper").children(".datepicker-label"),b=new Date(c(this).val()),
b=b.getDate()+" "+m[f.lang][b.getMonth()]+" "+b.getFullYear();if(f.dateRange){d.text()===f.labelText&&(d.html('<span class="label-from"></span>'),c('<span class="label-to"></span>').appendTo(d));var g=d.children(".label-from"),d=d.children(".label-to");switch(c(this).attr("class")){case "date-from":g.text(b);a(d,g);break;case "date-to":d.text(b),a(g,g)}}else d.text(b)})}function q(a){var d=a.year,b=a.month,c=a.shiftYear,f=a.direction;b++;if(c)f?d++:d--;else{f?b++:b--;switch(b){case 0:b+=12;d--;break;
case 13:b-=12,d++}b=[d,b];d=b[0];b=b[1]}d=new s(d,b);b=a.yearInner;c=a.monthInner;a=a.tableInner;c&&c.text(d.calendarMonth);b.text(d.calendarYear);a.html(d.calendarBody)}function E(){var a=c(this).parents(".datepicker-wrapper").children(".datepicker-label"),d=a.next();a.click(function(){d.fadeToggle("fast");d.toggleClass("expanded")});c(document).click(function(a){c(a.target).closest(".datepicker-wrapper").length||c(a.target).closest("td").length||(d.hasClass("expanded")&&(d.removeClass("expanded"),
d.fadeOut("fast")),a.stopPropagation())})}function s(a,c){function b(a){a=a.getDay();0===a&&(a=7);return a-1}for(var g=c-1,k=new Date(a,g),h="<table><tr>",e=0;e<x[f.lang].length;e++)h+="<th>"+x[f.lang][e]+"</th>";for(var h=h+"</tr>",e=0,l=b(k)-1;e<b(k);e++,l--)h+='<td class="not-current-month">'+(new Date(a,g,-l)).getDate()+"</td>";for(l=1;k.getMonth()===g;)h+="<td>"+k.getDate()+"</td>",6===b(k)%7&&(h+="<tr></tr>"),k.setDate(k.getDate()+1),l++;if(b(k))for(e=b(k);7>e;e++,l++)h+='<td class="not-current-month">'+
(new Date(a,g,l)).getDate()+"</td>";g=m[f.lang][g];this.calendarYear=a;this.calendarMonth=g;this.calendarBody=h}var f=c.extend({},{startYear:(new Date).getFullYear(),startMonth:(new Date).getMonth()+1,labelText:"Choose a date",lang:"en",dateRange:!1,fixedRange:!1,fixedRangeInner:c(this).parent(),showInLabel:!1},y),m={ru:"\u042f\u043d\u0432\u0430\u0440\u044c \u0424\u0435\u0432\u0440\u0430\u043b\u044c \u041c\u0430\u0440\u0442 \u0410\u043f\u0440\u0435\u043b\u044c \u041c\u0430\u0439 \u0418\u044e\u043d\u044c \u0418\u044e\u043b\u044c \u0410\u0432\u0433\u0443\u0441\u0442 \u0421\u0435\u043d\u0442\u044f\u0431\u0440\u044c \u041e\u043a\u0442\u044f\u0431\u0440\u044c \u041d\u043e\u044f\u0431\u0440\u044c \u0414\u0435\u043a\u0430\u0431\u0440\u044c".split(" "),
en:"Jan Feb March Apr May June July Aug Sept Oct Nov Dec".split(" ")},x={ru:"\u043f\u043d \u0432\u0442 \u0441\u0440 \u0447\u0442 \u043f\u0442 \u0441\u0431 \u0432\u0441".split(" "),en:"Mon Tue Wed Thu Fri Sat Sun".split(" ")};return this.each(function(){c(this).is('input[type="date"]')?(c(this).each(z),c(this).each(A),f.dateRange&&(c(this).each(B),f.fixedRange&&(c(this).each(C),c(this).each(D))),c(this).each(E),c(this).each(t),c(this).each(u),f.showInLabel&&c(this).each(v)):console.error("Illegal choice")})}})(jQuery);